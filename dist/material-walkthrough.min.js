!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.MaterialWalkthrough=e()}(this,function(){"use strict";function n(n,e){for(var t,o=arguments.length,i=Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];(r[n]||r.ALL)&&(t=console).log.apply(t,[n+": "+e].concat(i))}!function(n,e){void 0===e&&(e={});var t=e.insertAt;if(n){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===t&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=n:o.appendChild(document.createTextNode(n))}}("/**\n * Copyright 2017 Esset Software LTD.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nbody {\n    margin: 0px; /* Having problems with getClientRects. Webkit apply 8px for maring in body. Reseting body */\n    position: relative; /* FIX FROM ISSUE #30 */\n}\n#walk-bounds {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100%;\n    z-index: 1000;\n    overflow: hidden;\n    pointer-events: none;\n}\n/* END */\n\n#walk-wrapper {\n    pointer-events: all;\n    transform: translateZ(0);\n    position: absolute;\n    color: white;\n    z-index: 1000;\n    display: none;\n}\n\n#walk-wrapper.opened {\n    transition: 0.25s;\n}\n\n#walk-wrapper.closed {\n    height: 1000px !important;\n    width: 1000px !important;\n    opacity: 0;\n}\n\n#walk-wrapper.closed #walk-content-wrapper {\n    display: none;\n}\n\n#walk-wrapper:before {\n    content: '';\n    display: block;\n    position: absolute;\n    background: transparent;\n    border: solid 0vw;\n    border-radius: 50%;\n    border-color: inherit;\n    width: inherit;\n    height: inherit;\n    margin-top: 0vw;\n    margin-left: 0vw;\n    opacity: .9;\n    box-sizing: content-box !important;\n    transition: border-width 0.25s ease-in, margin 0.25s ease-in;\n}\n\n#walk-wrapper.opened:before {\n    border-width: 200vw;\n    margin-left: -200vw;\n    margin-top: -200vw;\n}\n\n#walk-wrapper:after {\n    content: ' ';\n    box-sizing: content-box;\n    position: absolute;\n    top: -1px;\n    left: -1px;\n    width: 100%;\n    height: 100%;\n    border: 1px solid white;\n    border-radius: 50%;\n    box-shadow: inset 0px 0px 10px rgba(0,0,0,0.5);\n}\n\n#walk-wrapper #walk-content-wrapper {\n    position: relative;\n    min-width: 200px;\n    width: 33vw;\n    font-family: 'Roboto', sans-serif;\n    font-size: 24px;\n\n    /* DEFAULT POSITION */\n    top: 100%;\n    left: 100%;\n}\n\n#walk-wrapper #walk-action {\n    height: 36px;\n    padding: 0 2rem;\n    margin-top: 10px;\n    background-color: rgba(255, 255, 255, 0.2);\n    border: 0;\n    border-radius: 2px;\n    letter-spacing: 1px;\n    font-size: 15px;\n    font-weight: bold;\n    text-transform: uppercase;\n    color: white;\n    display: inline-block;\n    flex-flow: initial;\n}\n\n#walk-wrapper #walk-action:hover {\n    background-color: rgba(255, 255, 255, 0.25);\n}\n\n/*\nTODO: Make it responsible with layout breakpoints.\n    * The walk border\n    * The content text\n*/\n@media all and (max-width: 768px) {\n    #walk-wrapper.opened:before {\n        border-width: 320px;\n        margin-left: -320px;\n        margin-top: -320px;\n    }\n    #walk-wrapper.transiting:before {\n        border-width: 50px !important;\n        margin-left: -50px !important;\n        margin-top: -50px !important;\n    }\n    #walk-wrapper #walk-content-wrapper {\n        width: 270px;\n        font-family: 'Roboto', sans-serif;\n        font-size: 18px;\n    }\n}",{});!function(){function n(n){this.value=n}function e(e){function t(o,i){try{var a=e[o](i),l=a.value;l instanceof n?Promise.resolve(l.value).then(function(n){t("next",n)},function(n){t("throw",n)}):r(a.done?"return":"normal",a.value)}catch(n){r("throw",n)}}function r(n,e){switch(n){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?t(o.key,o.arg):i=null}var o,i;this._invoke=function(n,e){return new Promise(function(r,a){var l={key:n,arg:e,resolve:r,reject:a,next:null};i?i=i.next=l:(o=i=l,t(n,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(n){return this._invoke("next",n)},e.prototype.throw=function(n){return this._invoke("throw",n)},e.prototype.return=function(n){return this._invoke("return",n)}}();var e=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},t=function(){function n(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),r={MSG:!0,WALK_CONTENT:!0,WALK_CONTENT_TOP:!0,WALK_LOCK:!0,WALK_SCROLL:!0,ALL:!0},o=function(n){return"string"==typeof n?document.querySelector(n):n},i=function(n,e){Object.keys(e).forEach(function(t){n.style[t]=e[t]})},a=function(n,e){var t=document.createElement("div");t.innerHTML=e,n.appendChild(t.children[0])},l=function(n,e){n.classList.remove(e)},p=function(n,e){n.classList.add(e)},s={keys:{37:1,38:1,39:1,40:1,32:1,33:1,34:1},preventDefault:function(n){(n=n||window.event).preventDefault&&n.preventDefault(),n.returnValue=!1},preventDefaultForScrollKeys:function(n){if(s.keys[n.keyCode])return s.preventDefault(n),!1},disable:function(){i(o("html"),{height:"100vh",overflow:"hidden"});var n=s.preventDefault,e=s.preventDefaultForScrollKeys;window.addEventListener&&window.addEventListener("DOMMouseScroll",n,!1),window.onwheel=n,window.onmousewheel=document.onmousewheel=n,window.ontouchmove=n,document.onkeydown=e},enable:function(){i(o("html"),{height:"",overflow:"auto"}),window.removeEventListener&&window.removeEventListener("DOMMouseScroll",s.preventDefault,!1),window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null,document.onkeydown=null}},c=function(){function r(){e(this,r)}return t(r,null,[{key:"_init",value:function(){a(o("body"),r.ELEMENT_TEMPLATE),r._wrapper=o("#walk-wrapper"),r._contentWrapper=o("#walk-content-wrapper"),r._content=o("#walk-content"),r._actionButton=o("#walk-action"),r.isInitialized=!0}},{key:"_setWalker",value:function(e){var t=o(e.target);n("MSG","-------------------------------------"),n("MSG","Setting a walk to #"+t.id),n("WALK_SETUP","Properties:\n"+JSON.stringify(e,null,2)),r._setupListeners(t,e.onClose),i(r._contentWrapper,{display:"none"}),r._locateTarget(t,function(){r._setProperties(e.content,e.color,e.acceptText),i(r._wrapper,{display:"block"}),r._renderFrame(t,function(){p(r._wrapper,"opened"),r._renderContent(t,function(){i(r._contentWrapper,{display:"block"})}),r._renderContent(t,function(){i(r._contentWrapper,{display:"block"})})})}),n("MSG","Walk created. Calling onSet() (if exists)"),e.onSet&&e.onSet()}},{key:"_createUpdateHandler",value:function(e){n("WALK_UPDATE","Creating UpdateHandler for #"+e.id);var t=function(){n("MSG","Updating and rendering"),r._locateTarget(e,function(){r._renderFrame(e,function(){r._renderContent(e)})})};return t.toString=function(){return"updateHandler -> #"+e.id},t}},{key:"_setupListeners",value:function(n,e){r._instance.updateHandler&&r._flushListeners(),r._instance.updateHandler=r._createUpdateHandler(n),window.addEventListener("resize",r._instance.updateHandler),r._instance.mutationObserver=new MutationObserver(r._instance.updateHandler),r._instance.mutationObserver.observe(document.body,{childList:!0,subtree:!0}),r._actionButton.addEventListener("click",function n(){var t=!!r._instance.points&&!!r._instance.points[r._instance.currentIndex+1],o=function(){t?(r._instance.currentIndex++,r._setWalker(r._instance.points[r._instance.currentIndex])):(r._instance.currentIndex=0,r._instance.points=null,r._instance.onCloseCallback&&r._instance.onCloseCallback(),r._instance.onCloseCallback=null,r.closeWalker()),r._actionButton.removeEventListener("click",n)};e&&e(),window.innerWidth<768&&t?(p(r._wrapper,"transiting"),i(r._contentWrapper,{display:"none"}),setTimeout(function(){l(r._wrapper,"transiting"),o()},r.TRANSITION_DURATION)):o()})}},{key:"_flushListeners",value:function(){n("WALK_UPDATER","Flushing handlers\n"+r._instance.updateHandler),r._instance.mutationObserver&&r._instance.mutationObserver.disconnect(),r._instance.mutationObserver=null,window.removeEventListener("resize",r._instance.updateHandler)}},{key:"_setProperties",value:function(n,e,t){i(r._wrapper,{borderColor:e=e||r.DEFAULT_COLOR}),r._content.innerHTML=n,r._actionButton.innerHTML=t||r.DEFAULT_ACCEPT_TEXT}},{key:"_locateTarget",value:function(e,t){var o=e.offsetTop,i=window.innerHeight,a=r.CURRENT_DOCUMENT_HEIGHT-window.innerHeight,l=e.getClientRects()[0],p=l.height,s=l.width,c=o-i/2+(p>s?p:s)/2,d=c>a?a:c;n("WALK_LOCK","Moving Scroll to:",d),n("WALK_LOCK","windowHeight:",i),setTimeout(function(){return window.scrollTo(0,d)},0),t&&t()}},{key:"_renderFrame",value:function(e,t){var o=e.getClientRects()[0],a=o.height,l=o.width,p=o.top,s=o.left,c=a>l?a:l;c<r.MIN_SIZE&&(c=r.MIN_SIZE),n("WALK_LOCK","Walk hole size "+c+"px");var d={height:c+r.GUTTER+"px",width:c+r.GUTTER+"px",marginLeft:-(c+r.GUTTER)/2+"px",marginTop:-(c+r.GUTTER)/2+"px",left:s+l/2+"px",top:p+a/2+"px"};i(r._wrapper,d),n("WALK_LOCK","Positioning \n"+JSON.stringify(d,2)),setTimeout(function(){t()},r.TRANSITION_DURATION+50)}},{key:"_renderContent",value:function(e,t){var o=r._wrapper.getBoundingClientRect(),a=o.x+(r._wrapper.offsetWidth-r.GUTTER)+r._contentWrapper.offsetWidth<window.innerWidth,l=o.x+r.GUTTER-r._contentWrapper.offsetWidth>0,p=o.y-r._contentWrapper.offsetHeight>0,s=o.y+r._contentWrapper.offsetHeight+r._contentWrapper.offsetHeight<window.innerHeight;n("WALK_CONTENT","itCanBeRenderedInRight: "+a),n("WALK_CONTENT","itCanBeRenderedInLeft: "+l),n("WALK_CONTENT","itCanBeRenderedInTop: "+p),n("WALK_CONTENT","itCanBeRenderedInBottom: "+s);var c="100%",d="100%",u=0,f=0,w="left";a||(c=l?"-"+r._contentWrapper.offsetWidth+"px":"calc(50% - 100px)",w=l?"right":"center",u=l?0:s?"20px":"-20px"),s||(d=p?"-"+r._contentWrapper.offsetHeight+"px":r._wrapper.offsetHeight/2-r._contentWrapper.offsetHeight/2+"px",f=p?0:a?"20px":"-20px"),i(r._contentWrapper,{left:c,top:d,textAlign:w,marginTop:u,marginLeft:f}),t&&t()}},{key:"walk",value:function(n,e){r._instance.points=n,r._instance.currentIndex=0,r._instance.onCloseCallback=e,r.to(n[0])}},{key:"to",value:function(n){r.CURRENT_DOCUMENT_HEIGHT=document.querySelector("html").offsetHeight,s.disable(),r.isInitialized||r._init(),l(r._wrapper,"closed"),r._setWalker(n)}},{key:"closeWalker",value:function(){n("MSG","Closing Walker"),r._flushListeners(),s.enable(),i(r._wrapper,{marginTop:"-500px",marginLeft:"-500px"}),p(r._wrapper,"closed"),setTimeout(function(){i(r._wrapper,{display:"none"}),l(r._wrapper,"opened"),n("MSG","Walker Closed!")},r.TRANSITION_DURATION)}}]),r}();return c.CURRENT_DOCUMENT_HEIGHT=0,c.DEFAULT_COLOR="#2196F3",c.DEFAULT_ACCEPT_TEXT="Ok",c.TRANSITION_DURATION=500,c.MIN_SIZE=60,c.GUTTER=20,c.ELEMENT_TEMPLATE="<div id='walk-wrapper'>\n            <div id='walk-content-wrapper'>\n                <div id='walk-content'></div>\n                <button id='walk-action'></button>\n            </div>\n        </div>",c.isInitialized=!1,c._wrapper=null,c._contentWrapper=null,c._content=null,c._actionButton=null,c._instance={updateHandler:null,mutationObserver:null,points:null,currentIndex:null,onCloseCallback:null},c});
