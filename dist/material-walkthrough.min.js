!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.MaterialWalkthrough=n()}(this,function(){"use strict";function e(e,n){for(var t,r=arguments.length,i=Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];(o[e]||o.ALL)&&(t=console).log.apply(t,[e+": "+n].concat(i))}!function(){function e(e){this.value=e}function n(n){function t(i,o){try{var a=n[i](o),l=a.value;l instanceof e?Promise.resolve(l.value).then(function(e){t("next",e)},function(e){t("throw",e)}):r(a.done?"return":"normal",a.value)}catch(e){r("throw",e)}}function r(e,n){switch(e){case"return":i.resolve({value:n,done:!0});break;case"throw":i.reject(n);break;default:i.resolve({value:n,done:!1})}(i=i.next)?t(i.key,i.arg):o=null}var i,o;this._invoke=function(e,n){return new Promise(function(r,a){var l={key:e,arg:n,resolve:r,reject:a,next:null};o?o=o.next=l:(i=o=l,t(e,n))})},"function"!=typeof n.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)}}();var n=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),r=function(){function e(){n(this,e)}return t(e,null,[{key:"get",value:function(e){return"string"==typeof e?document.querySelector(e):e}},{key:"setStyle",value:function(e,n){Object.keys(n).forEach(function(t){e.style[t]=n[t]})}},{key:"appendTo",value:function(e,n){var t=document.createElement("div");t.innerHTML=n,e.appendChild(t.children[0])}},{key:"removeClass",value:function(e,n){e.classList.remove(n)}},{key:"addClass",value:function(e,n){e.classList.add(n)}}]),e}(),i=function(){function e(){n(this,e)}return t(e,null,[{key:"preventDefault",value:function(e){(e=e||window.event).preventDefault&&e.preventDefault(),e.returnValue=!1}},{key:"preventDefaultForScrollKeys",value:function(n){if(e.keys[n.keyCode])return e.preventDefault(n),!1}},{key:"disable",value:function(){r.setStyle(r.get("html"),{height:"100vh",overflow:"hidden"});var n=e.preventDefault,t=e.preventDefaultForScrollKeys;window.addEventListener&&window.addEventListener("DOMMouseScroll",n,!1),window.onwheel=n,window.onmousewheel=document.onmousewheel=n,window.ontouchmove=n,document.onkeydown=t}},{key:"enable",value:function(){r.setStyle(r.get("html"),{height:"",overflow:"auto"}),window.removeEventListener&&window.removeEventListener("DOMMouseScroll",e.preventDefault,!1),window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null,document.onkeydown=null}}]),e}();i.keys={37:1,38:1,39:1,40:1,32:1,33:1,34:1},function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===t&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}("/**\n * Copyright 2017 Esset Software LTD.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nbody {\n    margin: 0px; /* Having problems with getClientRects. Webkit apply 8px for maring in body. Reseting body */\n    position: relative; /* FIX FROM ISSUE #30 */\n}\n#walk-bounds {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100%;\n    z-index: 1000;\n    overflow: hidden;\n    pointer-events: none;\n}\n/* END */\n\n#walk-wrapper {\n    pointer-events: all;\n    transform: translateZ(0);\n    position: absolute;\n    color: white; /* @TODO: Decide the contrast color based on the bright of the main color */\n    z-index: 1000;\n    display: none;\n}\n\n#walk-wrapper.opened {\n    transition: 0.25s;\n}\n\n#walk-wrapper.closed {\n    height: 1000px !important;\n    width: 1000px !important;\n    opacity: 0;\n}\n\n#walk-wrapper.closed #walk-content-wrapper {\n    display: none;\n}\n\n#walk-wrapper:before {\n    content: '';\n    display: block;\n    position: absolute;\n    background: transparent;\n    border: solid 0vw;\n    border-radius: 50%;\n    border-color: inherit;\n    width: inherit;\n    height: inherit;\n    margin-top: 0vw;\n    margin-left: 0vw;\n    opacity: inherit;\n    box-sizing: content-box !important;\n    transition: border-width 0.25s ease-in, margin 0.25s ease-in;\n}\n\n#walk-wrapper.opened:before {\n    border-width: 200vw;\n    margin-left: -200vw;\n    margin-top: -200vw;\n}\n\n#walk-wrapper:after {\n    content: ' ';\n    box-sizing: content-box;\n    position: absolute;\n    top: -1px;\n    left: -1px;\n    width: 100%;\n    height: 100%;\n    border: 1px solid white;\n    border-radius: 50%;\n    box-shadow: inset 0px 0px 10px rgba(0,0,0,0.5);\n}\n\n#walk-wrapper #walk-content-wrapper {\n    position: relative;\n    min-width: 200px;\n    width: 33vw;\n    font-family: 'Roboto', sans-serif;\n    font-size: 24px;\n    opacity: 1;\n    transition: 0.25s opacity;\n\n    /* DEFAULT POSITION */\n    top: 100%;\n    left: 100%;\n}\n\n#walk-wrapper:not(.opened) #walk-content-wrapper,\n#walk-wrapper.transiting #walk-content-wrapper {\n    opacity: 0;\n}\n\n#walk-wrapper #walk-action {\n    height: 36px;\n    padding: 0 2rem;\n    margin-top: 10px;\n    background-color: rgba(255, 255, 255, 0.2);\n    border: 0;\n    border-radius: 2px;\n    letter-spacing: 1px;\n    font-size: 15px;\n    font-weight: bold;\n    text-transform: uppercase;\n    color: white;\n    display: inline-block;\n    flex-flow: initial;\n}\n\n#walk-wrapper #walk-action:hover {\n    background-color: rgba(255, 255, 255, 0.25);\n}\n\n\n/** small rules **/\n#walk-wrapper.opened.small:before {\n    border-width: 320px;\n    margin-left: -320px;\n    margin-top: -320px;\n}\n#walk-wrapper.small #walk-content-wrapper {\n  max-width: 300px;\n}\n\n#walk-wrapper.transiting.small:not(.animations-disabled) {\n    display: none !important;\n}\n\n@media (max-width: 750px) {\n    #walk-wrapper.opened.small:before {\n        border-width: 50vw;\n        margin-left: -50vw;\n        margin-top: -50vw;\n    }\n}\n\n/** animations-disabled rules **/\n#walk-wrapper.animations-disabled,\n#walk-wrapper.animations-disabled:before {\n    transition: 0s;\n}\n\n#walk-wrapper.animations-disabled:before {\n    transition: 0.25s opacity;\n}\n\n#walk-wrapper.opened.animations-disabled:before {\n    opacity: .9;\n}\n\n#walk-wrapper.animations-disabled:before,\n#walk-wrapper.transiting.animations-disabled:before,\n#walk-wrapper.closed.animations-disabled:before,\n#walk-wrapper.closed.animations-disabled {\n    opacity: 0;\n}\n\n/*\nTODO: Make it responsible with layout breakpoints.\n    * The walk border\n    * The content text\n*/\n@media all and (max-width: 768px) {\n    #walk-wrapper #walk-content-wrapper {\n        max-width: 270px;\n        font-size: 18px;\n    }\n}\n",{});var o={MSG:!0,WALK_CONTENT:!0,WALK_CONTENT_TOP:!0,WALK_LOCK:!0,WALK_SCROLL:!0,ALL:!0},a=function(){function o(){n(this,o)}return t(o,null,[{key:"_init",value:function(){r.appendTo(r.get("body"),o.ELEMENT_TEMPLATE),o._wrapper=r.get("#walk-wrapper"),o._contentWrapper=r.get("#walk-content-wrapper"),o._content=r.get("#walk-content"),o._actionButton=r.get("#walk-action"),o.DISABLE_HUGE_ANIMATIONS&&r.addClass(o._wrapper,"animations-disabled"),o.FORCE_SMALL_BORDER&&r.addClass(o._wrapper,"small"),o.isInitialized=!0}},{key:"_setWalker",value:function(n){var t=r.get(n.target);e("MSG","-------------------------------------"),e("MSG","Setting a walk to #"+t.id),e("WALK_SETUP","Properties:\n"+JSON.stringify(n,null,2)),o._setupListeners(t,n.onClose),o._locateTarget(t,function(){o._setProperties(n.content,n.color,n.opacity,n.acceptText),r.setStyle(o._wrapper,{display:"block"}),o._renderFrame(t,function(){r.addClass(o._wrapper,"opened"),o._renderContent(t,function(){r.removeClass(o._wrapper,"transiting")}),o._renderContent(t,function(){r.removeClass(o._wrapper,"transiting")})})}),e("MSG","Walk created. Calling onSet() (if exists)"),n.onSet&&n.onSet()}},{key:"_createUpdateHandler",value:function(n){e("WALK_UPDATE","Creating UpdateHandler for #"+n.id);var t=function(){e("MSG","Updating and rendering"),o._locateTarget(n,function(){o._renderFrame(n,function(){o._renderContent(n)})})};return t.toString=function(){return"updateHandler -> #"+n.id},t}},{key:"_setupListeners",value:function(e,n){o._instance.updateHandler&&o._flushListeners(),o._instance.updateHandler=o._createUpdateHandler(e),window.addEventListener("resize",o._instance.updateHandler),o._instance.mutationObserver=new MutationObserver(o._instance.updateHandler),o._instance.mutationObserver.observe(document.body,{childList:!0,subtree:!0}),o._actionButton.addEventListener("click",function e(){var t=!!o._instance.points&&!!o._instance.points[o._instance.currentIndex+1];n&&n(),r.addClass(o._wrapper,"transiting"),setTimeout(function(){t?(o._instance.currentIndex++,o._setWalker(o._instance.points[o._instance.currentIndex])):(o._instance.currentIndex=0,o._instance.points=null,o._instance.onCloseCallback&&o._instance.onCloseCallback(),o._instance.onCloseCallback=null,o.closeWalker()),o._actionButton.removeEventListener("click",e)},o.TRANSITION_DURATION)})}},{key:"_flushListeners",value:function(){e("WALK_UPDATER","Flushing handlers\n"+o._instance.updateHandler),o._instance.mutationObserver&&o._instance.mutationObserver.disconnect(),o._instance.mutationObserver=null,window.removeEventListener("resize",o._instance.updateHandler)}},{key:"_setProperties",value:function(e,n,t,i){n=n||o.DEFAULT_COLOR,t=t||o.DEFAULT_OPACITY,r.setStyle(o._wrapper,{borderColor:n,opacity:t}),o._content.innerHTML=e,o._actionButton.innerHTML=i||o.DEFAULT_ACCEPT_TEXT}},{key:"_locateTarget",value:function(n,t){var r=n.offsetTop,i=window.innerHeight,a=o.CURRENT_DOCUMENT_HEIGHT-window.innerHeight,l=n.getClientRects()[0],s=l.height,p=l.width,d=r-i/2+(s>p?s:p)/2,c=d>a?a:d;e("WALK_LOCK","Moving Scroll to:",c),e("WALK_LOCK","windowHeight:",i),setTimeout(function(){return window.scrollTo(0,c)},0),t&&t()}},{key:"_renderFrame",value:function(n,t){var i=n.getClientRects()[0],a=i.height,l=i.width,s=i.top,p=i.left,d=a>l?a:l;d<o.MIN_SIZE&&(d=o.MIN_SIZE),e("WALK_LOCK","Walk hole size "+d+"px");var c={height:d+o.GUTTER+"px",width:d+o.GUTTER+"px",marginLeft:-(d+o.GUTTER)/2+"px",marginTop:-(d+o.GUTTER)/2+"px",left:p+l/2+"px",top:s+a/2+"px"};r.setStyle(o._wrapper,c),e("WALK_LOCK","Positioning \n"+JSON.stringify(c,2)),setTimeout(function(){t()},o.TRANSITION_DURATION/2)}},{key:"_renderContent",value:function(n,t){var i=o._wrapper.getBoundingClientRect(),a=i.x+(o._wrapper.offsetWidth-o.GUTTER)+o._contentWrapper.offsetWidth<window.innerWidth,l=i.x+o.GUTTER-o._contentWrapper.offsetWidth>0,s=i.y-o._contentWrapper.offsetHeight>0,p=i.y+o._contentWrapper.offsetHeight+o._wrapper.offsetHeight<window.innerHeight;e("WALK_CONTENT","itCanBeRenderedInRight: "+a),e("WALK_CONTENT","itCanBeRenderedInLeft: "+l),e("WALK_CONTENT","itCanBeRenderedInTop: "+s),e("WALK_CONTENT","itCanBeRenderedInBottom: "+p);var d="100%",c="100%",u=0,w=0,f="left";a||(d=l?"-"+o._contentWrapper.offsetWidth+"px":"calc(50% - 100px)",f=l?"right":"center",u=l?0:p?"20px":"-20px"),p||(c=s?"-"+o._contentWrapper.offsetHeight+"px":o._wrapper.offsetHeight/2-o._contentWrapper.offsetHeight/2+"px",w=s?0:a?"20px":"-20px"),r.setStyle(o._contentWrapper,{left:d,top:c,textAlign:f,marginTop:u,marginLeft:w}),t&&t()}},{key:"walk",value:function(e,n){o._instance.points=e,o._instance.currentIndex=0,o._instance.onCloseCallback=n,o.to(e[0])}},{key:"to",value:function(e){o.CURRENT_DOCUMENT_HEIGHT=document.querySelector("html").offsetHeight,i.disable(),o.isInitialized||o._init(),r.removeClass(o._wrapper,"closed"),o._setWalker(e)}},{key:"closeWalker",value:function(){e("MSG","Closing Walker"),o._flushListeners(),i.enable(),r.setStyle(o._wrapper,{marginTop:"-500px",marginLeft:"-500px",opacity:""}),r.addClass(o._wrapper,"closed"),setTimeout(function(){r.setStyle(o._wrapper,{display:"none"}),r.removeClass(o._wrapper,"opened"),r.removeClass(o._wrapper,"transiting"),e("MSG","Walker Closed!")},o.TRANSITION_DURATION)}}]),o}();return a.CURRENT_DOCUMENT_HEIGHT=0,a.DEFAULT_COLOR="#2196F3",a.DEFAULT_OPACITY=.9,a.DEFAULT_ACCEPT_TEXT="Ok",a.TRANSITION_DURATION=500,a.DISABLE_HUGE_ANIMATIONS=!1,a.FORCE_SMALL_BORDER=!1,a.MIN_SIZE=60,a.GUTTER=20,a.ELEMENT_TEMPLATE="<div id='walk-wrapper' class='"+(a.DISABLE_HUGE_ANIMATIONS?"animations-disabled":"")+" "+(a.FORCE_SMALL_BORDER?"small":"")+"'>\n      <div id='walk-content-wrapper'>\n        <div id='walk-content'></div>\n        <button id='walk-action'></button>\n      </div>\n    </div>",a.isInitialized=!1,a._wrapper=null,a._contentWrapper=null,a._content=null,a._actionButton=null,a._instance={updateHandler:null,mutationObserver:null,points:null,currentIndex:null,onCloseCallback:null},a});
